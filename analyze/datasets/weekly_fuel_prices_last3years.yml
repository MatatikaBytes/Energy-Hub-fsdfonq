version: datasets/v0.2
source: analyze/channels/fuel
title: Weekly average road fuel product price (Last 3 years)
questions: What is the average price of fuel for the last 3 years?
description: |-
  Road fuel and other petroleum product price statistics

  #fuel
metadata: |-
  {
    "name": "price_data",
    "label": "Weekly road fuel prices", 
    "related_table": {
      "columns": [
        {"name": "week_price_date", "label": "Date", "description": "Date"}
      ],
      "aggregates": [
        {"name": "ulsd", "label": "Diesel", "description": "ULSD (Diesel avg price)"},
        {"name": "ulsd_duty", "label": "Diesel Duty", "description": "ULSD (Duty portion)"},
        {"name": "ulsd_vat", "label": "Diesel VAT", "description": "ULSD (VAT portion)"},
        {"name": "ulsp", "label": "Unleaded", "description": "ULSP (Unleaded avg price)"},
        {"name": "ulsp_duty", "label": "Unleaded Duty", "description": "ULSP (Duty portion)"},
        {"name": "ulsp_vat", "label": "Unleaded VAT", "description": "ULSP (VAT portion)"}
      ]
    }
  }
visualisation: |-
  {"chartjs-chart": 
    {"chartType": "line", 
      "options": {
        "scales": {
          "y": {
            "beginAtZero": true
          }
        }
      }
    }
  }
query: |-
  select 
    price_date as "price_data.week_price_date",
    ulsd as "price_data.ulsd",
    ulsd_duty as "price_data.ulsd_duty",
    ulsd_vat as "price_data.ulsd_vat",
    ulsp as "price_data.ulsp",
    ulsp_duty as "price_data.ulsp_duty",
    ulsp_vat as "price_data.ulsp_vat"
  from vw_fuel_price_wk_avg
  where price_date::date > current_date - interval '3' year 
  order by price_date;

